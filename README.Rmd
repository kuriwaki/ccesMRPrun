---
title: "Running MRP with CCES"
output: github_document
---

<!-- badges: start -->
[![R build status](https://github.com/kuriwaki/ccesMRPrun/workflows/R-CMD-check/badge.svg)](https://github.com/kuriwaki/ccesMRPrun/actions)
<!-- badges: end -->

```{r, eval = FALSE}
remotes::install_github("kuriwaki/ccesMRPrun")
```


```{r, message=FALSE}
library(ccesMRPrun)
library(tidyverse)
```




To prepare, see <www.shirokuriwaki.com/ccesMRPprep>. 

# Fitting

This is a simple wrapper around `brms::brm` but with some custom priors and a binomial model as a default.

```{r, eval = FALSE}
cces_georgia <- read_rds("data-analysis/cc-count_GA.rds")

# don't run in readme, takes too long
fit <- fit_brms("yes | trials(n_response) ~ (1 | age) + (1 | edu) + (1 | cd)",
                cces_georgia)
```



# Poststratification

```{r}
# sample data (too large for package; not in github yet)
fit <- read_rds("data-analysis/fit_GA.rds")
summary(fit)
```

There are two main methods in this package: modeling and 

```{r}
cc_count <- read_rds("data-analysis/cc-count_GA.rds")
poststrat <- read_rds("data-analysis/by-cd-cell_poststrat_2018.rds")

drw <- poststrat_draws(fit, poststrat, cc_count)

drw
```

# summaries

We often care about the posterior mean and 95 percent credible intervals of the draws. 

```{r}
summ_sims(drw)
```

